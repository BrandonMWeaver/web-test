<!DOCTYPE html>
<html>
    <head>
        <style>
            body {
                margin: 0;
            }
            canvas {
                width: 100%;
                height: 100%;
            }
        </style>
        <title>webgl-test/threejs</title>
    </head>
    <body>
        <script src="https://threejs.org/build/three.js"></script>
        <script>
            const scene = new THREE.Scene();

            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);

            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 3;

            const createCube = (boxGeometry, phongMaterialColor, position) => {
                const geometry = new THREE.BoxGeometry(...boxGeometry);
                const material = new THREE.MeshPhongMaterial({ color: phongMaterialColor });
                const cube = new THREE.Mesh(geometry, material);
                cube.position.x = position.x;
                cube.position.y = position.y;
                cube.position.z = position.z;
                scene.add(cube);
                return cube;
            }

            const createLight = (color, intensity, position) => {
                const light = new THREE.DirectionalLight(color, intensity);
                light.position.set(position.x, position.y, position.z);
                scene.add(light);
                return light;
            }

            document.body.appendChild(renderer.domElement);

            const cubes = [
                createCube([1, 1, 1], 0x0000ff, { x: 1, y: -0.5, z: 0}),
                createCube([1, 1, 1], 0x00ff00, { x: -1, y: -0.5, z: 0}),
                createCube([1, 1, 1], 0xff0000, { x: 0, y: 1, z: 0})
            ];

            const light = createLight(0xffffff, 1, { x: 0, y: 5, z: 3});

            const update = (deltaTime) => {
                deltaTime *= 0.001;

                for (const cube of cubes) {
                    cube.rotation.x = deltaTime * 0.5;
                    cube.rotation.y = deltaTime * 0.5;
                }
                renderer.render(scene, camera);

                requestAnimationFrame(update);
            }

            const onWindowResize = () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            }
            window.addEventListener("resize", onWindowResize);

            requestAnimationFrame(update);
        </script>
    </body>
</html>
